<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta http-equiv="X-UA-Compatible" content="ie=edge">
		<title>Soup Launcher | Settings</title>
		<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
		<link rel="stylesheet" type="text/css" href="css/main.css">
		<link rel="stylesheet" type="text/css" href="css/login.css">
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
	</head>

	<body>
		<div class="container">
			<div class="versionbox">
                <form class="versionbox" onsubmit="save()" novalidate>
                    <div class="form-group">
                        <label for="memory">Memory allocation</label>
                        <input required type="range" min="514" class="custom-range form-control" id="memory" oninput="updateRamAmt(this.value)">
                    </div>

                    <span id="memAmt"></span>
                    <br><br>

                    <div class="form-group">
                        <label for="javaArgs">Enter java arguments to be used on every instance</label>
                        <input required type="text" class="form-control" id="javaArgs">
                    </div>

                    <script>
                        let os = require('os');
                        document.getElementById('memory').max = (os.totalmem() / (1024*1024));

                        function updateRamAmt(amt)
                        {
                            document.getElementById('memAmt').innerHTML = amt + " Mb";
                        }

                        let Store = require('../../dest/store.js').Store;

                        let store = new Store(
                        {
                            configName: 'user-data',
                            defaults: {}
                        });

                        document.getElementById('memory').value = store.get('memory').maxMemory;
                        updateRamAmt(store.get('memory').maxMemory);

                        document.getElementById('javaArgs').value = store.get('javaArgs').replace('\n', '').trim();

                        function save()
                        {
                            let mem = store.get('memory');
                            mem.maxMemory = parseInt(document.getElementById('memory').value);
                            
                            store.set('javaArgs', document.getElementById('javaArgs').value.replace('\n', '').trim());
                            store.set('memory', mem);
                            
                            window.close();
                        }
                    </script>

                    <br>
                    <button type="submit" class="btn btn-primary" id="submit">Save</button>
                </form>
			</div>
	
			<script>
            </script>
        	</div>
	</body>
</html>